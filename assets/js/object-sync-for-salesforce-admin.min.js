function salesforce_object_fields(){0===$(".salesforce_record_types_allowed > *").length&&$(".salesforce_record_types_allowed").hide(),0===$(".salesforce_record_type_default > *").length&&$(".salesforce_record_type_default").hide(),0===$(".pull_trigger_field > *").length&&$(".pull_trigger_field").hide();var a=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}();$("#salesforce_object").on("change",function(b){var c=this;a(function(){var a={action:"get_salesforce_object_description",include:["fields","recordTypeInfos"],field_type:"datetime",salesforce_object:c.value};$.post(ajaxurl,a,function(a){var b="",c="",d="";$(a.data.recordTypeInfos).length>0&&(b+='<label for="salesforce_record_types_allowed">Allowed Record Types:</label><div class="checkboxes">',$.each(a.data.recordTypeInfos,function(a,c){b+='<label><input type="checkbox" class="form-checkbox" value="'+a+'" name="salesforce_record_types_allowed['+a+']" id="salesforce_record_types_allowed-'+a+'"> '+c+"</label>"}),b+="</div>",c+='<label for="salesforce_record_type_default">Default Record Type:</label>',c+='<select name="salesforce_record_type_default" id="salesforce_record_type_default"><option value="">- Select record type -</option>',$.each(a.data.recordTypeInfos,function(a,b){c+='<option value="'+a+'">'+b+"</option>"})),$(".salesforce_record_types_allowed").html(b),$(".salesforce_record_type_default").html(c),$(a.data.fields).length>0&&(d+='<label for="pull_trigger_field">Date field to trigger pull:</label>',d+='<select name="pull_trigger_field" id="pull_trigger_field"><option value="">- Select date field -</option>',$.each(a.data.fields,function(a,b){d+='<option value="'+b.name+'">'+b.label+"</option>"}),d+="</select>",d+='<p class="description">These are date fields that can cause WordPress to pull an update from Salesforce, according to the <code>salesforce_pull</code> class.</p>'),$(".pull_trigger_field").html(d),""!==b?$(".salesforce_record_types_allowed").show():$(".salesforce_record_types_allowed").hide(),""!==c?$(".salesforce_record_type_default").show():$(".salesforce_record_type_default").hide(),""!==d?$(".pull_trigger_field").show():$(".pull_trigger_field").hide()})},1e3)})}function add_field_mapping_row(){$("#add-field-mapping").click(function(){$(this).text("Add another field mapping");var a=$("#salesforce_object").val(),b=$("#wordpress_object").val();if(""!==b&&""!==a){fieldmap_fields(b,a,$("table.fields tbody tr").length),$(this).parent().find(".missing-object").remove()}else $(this).parent().prepend('<div class="error missing-object"><span>You have to pick a WordPress object and a Salesforce object to add field mapping.</span></div>');return!1})}function fieldmap_fields(a,b,c){var d={action:"get_wp_sf_object_fields",wordpress_object:a,salesforce_object:b};$.post(ajaxurl,d,function(a){var b="";b+='<select name="wordpress_field['+c+']" id="wordpress_field-'+c+'">',b+='<option value="">- Select WordPress field -</option>',$.each(a.data.wordpress,function(a,c){b+='<option value="'+c.key+'">'+c.key+"</option>"}),b+="</select>";var d="";d+='<select name="salesforce_field['+c+']" id="salesforce_field-'+c+'">',d+='<option value="">- Select Salesforce field -</option>',$.each(a.data.salesforce,function(a,b){d+='<option value="'+b.name+'">'+b.label+"</option>"}),d+="</select>";var e='<tr><td class="column-wordpress_field">'+b+'</td><td class="column-salesforce_field">'+d+'</td><td class="column-is_prematch"><input type="checkbox" name="is_prematch['+c+']" id="is_prematch-'+c+'" value="1" /><td class="column-is_key"><input type="checkbox" name="is_key['+c+']" id="is_key-'+c+'" value="1" /></td><td class="column-direction"><div class="radios"><label><input type="radio" value="sf_wp" name="direction['+c+']" id="direction-'+c+'-sf-wp">  Salesforce to WordPress</label><label><input type="radio" value="wp_sf" name="direction['+c+']" id="direction-'+c+'-wp-sf">  WordPress to Salesforce</label><label><input type="radio" value="sync" name="direction['+c+']" id="direction-'+c+'-sync" checked>  Sync</label></div></td><td class="column-is_delete"><input type="checkbox" name="is_delete['+c+']" id="is_delete-'+c+'" value="1" /></td></tr>';$("table.fields tbody").append(e)})}function push_and_pull_objects(){$(".salesforce_user_ajax_message").hide(),$("#wordpress_object_ajax").length>0&&$(".push_to_salesforce_button").on("click",function(){var a=$("#wordpress_object_ajax").val(),b=$("#wordpress_id_ajax").val(),c={action:"push_to_salesforce",wordpress_object:a,wordpress_id:b};return $.post(ajaxurl,c,function(a){!0===a.success&&(update_salesforce_user_summary(),$(".salesforce_user_ajax_message").width($(".mapped-salesforce-user").width()-27),$(".salesforce_user_ajax_message").html("<p>This object has been pushed to Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1}),$(".pull_from_salesforce_button").on("click",function(){var a=$("#salesforce_id_ajax").val(),b=$("#wordpress_object_ajax").val(),c={action:"pull_from_salesforce",salesforce_id:a,wordpress_object:b};return $.post(ajaxurl,c,function(a){!0===a.success&&(update_salesforce_user_summary(),$(".salesforce_user_ajax_message").width($(".mapped-salesforce-user").width()-27),$(".salesforce_user_ajax_message").html("<p>This object has been pulled from Salesforce.</p>").fadeIn().delay(4e3).fadeOut())}),!1})}function update_salesforce_user_summary(){var a=$("#mapping_id_ajax").val(),b={action:"refresh_mapped_data",mapping_id:a};$.post(ajaxurl,b,function(a){!0===a.success&&($("td.last_sync_message").text(a.data.last_sync_message),$("td.last_sync_action").text(a.data.last_sync_action),$("td.last_sync_status").text(a.data.last_sync_status),$("td.last_sync").text(a.data.last_sync),"1"===a.data.last_sync_status&&$("td.last_sync_status").text("success"))})}var $=window.jQuery;$(document).on("click",".column-is_prematch input",function(){$(".column-is_prematch input").not(this).prop("checked",!1)}),$(document).on("click",".column-is_key input",function(){$(".column-is_key input").not(this).prop("checked",!1)}),$(document).ready(function(){var a;$("#wordpress_object, #salesforce_object").on("change",function(){clearTimeout(a),a=setTimeout(function(){$("table.fields tbody tr").fadeOut(),$("table.fields tbody tr").remove()},1e3)}),$(document).ajaxStart(function(){$(".spinner").addClass("is-active")}).ajaxStop(function(){$(".spinner").removeClass("is-active")}),salesforce_object_fields(),add_field_mapping_row(),push_and_pull_objects()});